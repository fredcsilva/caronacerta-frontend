<div class="cadastro-container">
  <p-stepper [value]="activeStep">
    <!-- ETAPA 1: Dados Pessoais -->
    <p-step-item [value]="1">
      <p-step>Dados Pessoais</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="step-content">
            <div class="icon-section">
              <i class="pi pi-user icon-main"></i>
            </div>

            <div class="subtitle-section">
              <p class="subtitle-text">Complete seus dados pessoais</p>
            </div>

            <form class="form-section">
              <div class="form-field">
                <label class="field-label">Foto de Perfil (Opcional)</label>
                <p-fileUpload 
                  mode="basic" 
                  name="foto"
                  accept="image/*"
                  [maxFileSize]="2000000"
                  chooseLabel="Escolher Foto"
                  (onSelect)="onUploadFoto($event)"
                  [auto]="true">
                </p-fileUpload>
              </div>

              <div class="form-field">
                <label for="dataNascimento" class="field-label">Data de Nascimento *</label>
                <p-datepicker
                  [(ngModel)]="dataNascimento"
                  name="dataNascimento"
                  dateFormat="dd/mm/yy"
                  [showIcon]="true"
                  placeholder="DD/MM/AAAA"
                  [minDate]="minDataNascimento"
                  [maxDate]="maxDataNascimento">
                </p-datepicker>
              </div>

              <div class="form-field">
                <label for="telefone" class="field-label">Telefone *</label>
                <p-inputMask 
                  [(ngModel)]="telefone"
                  name="telefone"
                  mask="(99) 99999-9999"
                  placeholder="(00) 00000-0000">
                </p-inputMask>
              </div>

              <div class="form-field">
                <label for="genero" class="field-label">Gênero *</label>
                <p-select 
                  [(ngModel)]="generoSelecionado"
                  name="genero"
                  [options]="generos"
                  optionLabel="label"
                  placeholder="Selecione seu gênero"
                  [showClear]="true">
                </p-select>
              </div>
            </form>
          </div>

          <div class="py-6">
            <p-button 
              label="Próximo" 
              icon="pi pi-arrow-right"
              iconPos="right"
              [disabled]="!validarEtapa1()"
              (onClick)="activateCallback(2)">
            </p-button>
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- ETAPA 2: Condomínio -->
    <p-step-item [value]="2">
      <p-step>Condomínio</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="step-content">
            <div class="icon-section">
              <i class="pi pi-building icon-main"></i>
            </div>

            <div class="subtitle-section">
              <p class="subtitle-text">Informe os dados do seu condomínio</p>
            </div>

            <form class="form-section">
              <div class="form-field">
                <label for="condominio" class="field-label">Condomínio *</label>
                <p-select 
                  [(ngModel)]="condominioSelecionado"
                  name="condominio"
                  [options]="condominios"
                  optionLabel="nome"
                  placeholder="Selecione o condomínio"
                  (onChange)="onCondominioChange()"
                  [showClear]="true">
                </p-select>
              </div>

              <div class="form-field">
                <label for="bloco" class="field-label">Bloco *</label>
                <p-select 
                  [(ngModel)]="blocoSelecionado"
                  name="bloco"
                  [options]="blocos"
                  optionLabel="nome"
                  placeholder="Selecione o bloco"
                  [disabled]="!condominioSelecionado"
                  (onChange)="onBlocoChange()"
                  [showClear]="true">
                </p-select>
              </div>

              <div class="form-field">
                <label for="apartamento" class="field-label">Apartamento *</label>
                <p-select 
                  [(ngModel)]="apartamentoSelecionado"
                  name="apartamento"
                  [options]="apartamentos"
                  optionLabel="numero"
                  placeholder="Selecione o apartamento"
                  [disabled]="!blocoSelecionado"
                  [showClear]="true">
                </p-select>
              </div>
            </form>
          </div>

          <div class="flex py-6 gap-2">
            <p-button 
              label="Voltar" 
              severity="secondary" 
              icon="pi pi-arrow-left"
              (onClick)="activateCallback(1)">
            </p-button>
            <p-button 
              label="Próximo"
              icon="pi pi-arrow-right"
              iconPos="right"
              [disabled]="!validarEtapa2()"
              (onClick)="activateCallback(3)">
            </p-button>
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- ETAPA 3: Termos -->
    <p-step-item [value]="3">
      <p-step>Termos</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="step-content">
            <div class="icon-section">
              <i class="pi pi-file-check icon-main"></i>
            </div>

            <div class="subtitle-section">
              <p class="subtitle-text">Leia e aceite os termos e condições</p>
            </div>

            <p-accordion [value]="['0']">
              <p-accordionpanel value="0">
                <p-accordionheader>Termos e Condições de Uso</p-accordionheader>
                <p-accordioncontent>
                  <div class="terms-scroll">
                    <h3>Termos e Condições de Uso</h3>
                    <p>Bem-vindo ao Carona Certa. Ao usar nosso aplicativo, você concorda com os seguintes termos:</p>
                    
                    <h4>1. Aceitação dos Termos</h4>
                    <p>Ao acessar e usar este aplicativo, você aceita e concorda em cumprir estes Termos e Condições de Uso.</p>
                    
                    <h4>2. Uso do Serviço</h4>
                    <p>O Carona Certa é uma plataforma de compartilhamento de caronas entre moradores de condomínios. O serviço deve ser usado de forma responsável e respeitosa.</p>
                    
                    <h4>3. Responsabilidades do Usuário</h4>
                    <p>Você é responsável por manter a confidencialidade de sua conta e senha. Todas as atividades realizadas em sua conta são de sua responsabilidade.</p>
                  </div>
                </p-accordioncontent>
              </p-accordionpanel>

              <p-accordionpanel value="1">
                <p-accordionheader>Política de Privacidade</p-accordionheader>
                <p-accordioncontent>
                  <div class="terms-scroll">
                    <h3>Política de Privacidade</h3>
                    <p>Esta Política de Privacidade descreve como coletamos, usamos e protegemos suas informações pessoais.</p>
                    
                    <h4>1. Informações Coletadas</h4>
                    <p>Coletamos informações que você nos fornece diretamente, como nome, e-mail, telefone, endereço e foto de perfil.</p>
                    
                    <h4>2. Uso das Informações</h4>
                    <p>Usamos suas informações para fornecer e melhorar nossos serviços, processar transações, enviar notificações e comunicações relevantes.</p>
                  </div>
                </p-accordioncontent>
              </p-accordionpanel>

              <p-accordionpanel value="2">
                <p-accordionheader>Confirmação</p-accordionheader>
                <p-accordioncontent>
                  <div class="confirmation-content">
                    <h3>Confirme sua Aceitação</h3>
                    <p>Para continuar, você deve concordar com os Termos e Condições e a Política de Privacidade.</p>
                    
                    <div class="checkbox-group">
                      <div class="checkbox-item">
                        <p-checkbox 
                          [(ngModel)]="aceitouTermos"
                          name="termosAceitos"
                          [binary]="true"
                          inputId="termosAceitos">
                        </p-checkbox>
                        <label for="termosAceitos" class="checkbox-label">
                          Li e aceito os Termos e Condições
                        </label>
                      </div>

                      <div class="checkbox-item">
                        <p-checkbox 
                          [(ngModel)]="aceitouPrivacidade"
                          name="privacidadeAceita"
                          [binary]="true"
                          inputId="privacidadeAceita">
                        </p-checkbox>
                        <label for="privacidadeAceita" class="checkbox-label">
                          Li e aceito a Política de Privacidade
                        </label>
                      </div>
                    </div>
                  </div>
                </p-accordioncontent>
              </p-accordionpanel>
            </p-accordion>
          </div>

          <div class="flex py-6 gap-2">
            <p-button 
              label="Voltar" 
              severity="secondary" 
              icon="pi pi-arrow-left"
              (onClick)="activateCallback(2)">
            </p-button>
            <p-button 
              label="Confirmar"
              icon="pi pi-check"
              iconPos="right"
              [disabled]="!validarEtapa3()"
              (onClick)="onFinalizarCadastro(); activateCallback(4)">
            </p-button>
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- ETAPA 4: Sucesso -->
    <p-step-item [value]="4">
      <p-step>Concluído</p-step>
      <p-step-panel>
        <ng-template #content>
          <div class="step-content success-content">
            <div class="icon-section">
              <i class="pi pi-check-circle icon-success"></i>
            </div>

            <h2 class="success-title">Cadastro Concluído!</h2>
            <p class="success-text">Seu cadastro complementar foi realizado com sucesso. Agora você pode começar a usar o Carona Certa!</p>
          </div>

          <div class="py-6">
            <p-button 
              label="Ir para Listar Caronas"
              icon="pi pi-arrow-right"
              iconPos="right"
              (onClick)="onIrParaListarCaronas()">
            </p-button>
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>
  </p-stepper>
</div>